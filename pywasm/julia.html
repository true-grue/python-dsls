<!DOCTYPE html>
<html>
<body>
<div style='width:500px; margin:0 auto;'>
<canvas id='screen' style='border:1px solid black;'></canvas>
<div>
<input type='range' min='0' max='1009' value='500' id='slider' style='width: 500px'>
</div>
</div>
<script>
var canvas = document.getElementById('screen');
var ctx = canvas.getContext('2d');
canvas.width  = 200;
canvas.height = 200;
canvas.style.width  = '500px';
canvas.style.height = '500px';
ctx.transform(1, 0, 0, -1, 0, canvas.height);
var imageData = ctx.createImageData(canvas.width, canvas.height);
var mem = [];
var lib = {
    list: function () {
        mem.push([]);
        return mem.length - 1;
    },
    append: function (n, x) {
        mem[n].push(x);
    },
    get: function (n, i) {
        return mem[n][i];
    },
    set: function (n, i, x) {
        mem[n][i] = x;
    },
    imshow: function (image) {
        image = mem[image];
        for (let y = 0; y < image.length; y++) {
            for (let x = 0; x < mem[image[0]].length; x++) {
                p = 4 * (y * canvas.width + x);
                color = mem[mem[image[y]][x]];
                imageData.data[p + 0] = color[0];
                imageData.data[p + 1] = color[1];
                imageData.data[p + 2] = color[2];
                imageData.data[p + 3] = 255;
            }
        }
    }
};
var code = new Uint8Array(
[0, 97, 115, 109, 1, 0, 0, 0, 1, 50, 8, 96, 1, 124, 0, 96, 0, 1, 124, 96, 2, 124, 124, 0, 96, 2, 124, 124, 1, 124, 96, 3, 124, 124, 124, 0, 96, 4, 124, 124, 124, 124, 0, 96, 3, 124, 124, 124, 1, 124, 96, 7, 124, 124, 124, 124, 124, 124, 124, 0, 2, 58, 5, 3, 108, 105, 98, 6, 105, 109, 115, 104, 111, 119, 0, 0, 3, 108, 105, 98, 4, 108, 105, 115, 116, 0, 1, 3, 108, 105, 98, 6, 97, 112, 112, 101, 110, 100, 0, 2, 3, 108, 105, 98, 3, 103, 101, 116, 0, 3, 3, 108, 105, 98, 3, 115, 101, 116, 0, 4, 3, 6, 5, 3, 5, 6, 7, 0, 7, 57, 5, 11, 109, 97, 107, 101, 95, 109, 97, 116, 114, 105, 120, 0, 5, 9, 115, 101, 116, 95, 112, 105, 120, 101, 108, 0, 6, 5, 106, 117, 108, 105, 97, 0, 7, 12, 109, 97, 107, 101, 95, 102, 114, 97, 99, 116, 97, 108, 0, 8, 4, 109, 97, 105, 110, 0, 9, 10, 246, 4, 5, 152, 1, 1, 5, 124, 16, 1, 33, 2, 68, 0, 0, 0, 0, 0, 0, 0, 0, 33, 3, 2, 64, 3, 64, 32, 3, 32, 1, 99, 69, 13, 1, 16, 1, 33, 4, 68, 0, 0, 0, 0, 0, 0, 0, 0, 33, 5, 2, 64, 3, 64, 32, 5, 32, 0, 99, 69, 13, 1, 16, 1, 33, 6, 32, 6, 68, 0, 0, 0, 0, 0, 0, 0, 0, 16, 2, 32, 6, 68, 0, 0, 0, 0, 0, 0, 0, 0, 16, 2, 32, 6, 68, 0, 0, 0, 0, 0, 0, 0, 0, 16, 2, 32, 4, 32, 6, 16, 2, 32, 5, 68, 0, 0, 0, 0, 0, 0, 240, 63, 160, 33, 5, 12, 0, 11, 11, 32, 2, 32, 4, 16, 2, 32, 3, 68, 0, 0, 0, 0, 0, 0, 240, 63, 160, 33, 3, 12, 0, 11, 11, 32, 2, 15, 11, 47, 0, 32, 0, 68, 0, 0, 0, 0, 0, 0, 0, 0, 32, 1, 16, 4, 32, 0, 68, 0, 0, 0, 0, 0, 0, 240, 63, 32, 2, 16, 4, 32, 0, 68, 0, 0, 0, 0, 0, 0, 0, 64, 32, 3, 16, 4, 11, 157, 1, 1, 4, 124, 68, 0, 0, 0, 0, 0, 0, 0, 0, 33, 3, 32, 0, 33, 4, 32, 1, 33, 5, 2, 64, 3, 64, 32, 3, 32, 2, 99, 69, 13, 1, 32, 4, 32, 4, 162, 32, 5, 32, 5, 162, 161, 68, 154, 153, 153, 153, 153, 153, 185, 63, 161, 33, 6, 68, 0, 0, 0, 0, 0, 0, 0, 64, 32, 4, 162, 32, 5, 162, 68, 205, 204, 204, 204, 204, 204, 228, 63, 160, 33, 5, 32, 6, 33, 4, 32, 4, 32, 4, 162, 32, 5, 32, 5, 162, 160, 68, 0, 0, 0, 0, 0, 0, 16, 64, 102, 4, 64, 68, 0, 0, 0, 0, 0, 224, 111, 64, 32, 3, 162, 32, 2, 163, 15, 11, 32, 3, 68, 0, 0, 0, 0, 0, 0, 240, 63, 160, 33, 3, 12, 0, 11, 11, 68, 0, 0, 0, 0, 0, 224, 111, 64, 15, 11, 168, 1, 1, 7, 124, 32, 2, 32, 0, 161, 32, 5, 163, 33, 7, 32, 3, 32, 1, 161, 32, 6, 163, 33, 8, 68, 0, 0, 0, 0, 0, 0, 0, 0, 33, 9, 2, 64, 3, 64, 32, 9, 32, 5, 99, 69, 13, 1, 32, 0, 32, 9, 32, 7, 162, 160, 33, 10, 68, 0, 0, 0, 0, 0, 0, 0, 0, 33, 11, 2, 64, 3, 64, 32, 11, 32, 6, 99, 69, 13, 1, 32, 1, 32, 11, 32, 8, 162, 160, 33, 12, 32, 10, 32, 12, 68, 0, 0, 0, 0, 0, 0, 105, 64, 16, 7, 33, 13, 32, 4, 32, 11, 16, 3, 32, 9, 16, 3, 32, 13, 32, 13, 68, 0, 0, 0, 0, 0, 0, 73, 64, 16, 6, 32, 11, 68, 0, 0, 0, 0, 0, 0, 240, 63, 160, 33, 11, 12, 0, 11, 11, 32, 9, 68, 0, 0, 0, 0, 0, 0, 240, 63, 160, 33, 9, 12, 0, 11, 11, 11, 97, 1, 3, 124, 68, 0, 0, 0, 0, 0, 0, 105, 64, 33, 1, 68, 0, 0, 0, 0, 0, 0, 105, 64, 33, 2, 32, 1, 32, 2, 16, 5, 33, 3, 68, 0, 0, 0, 0, 0, 0, 240, 63, 154, 32, 0, 161, 68, 0, 0, 0, 0, 0, 0, 224, 63, 160, 32, 0, 154, 68, 0, 0, 0, 0, 0, 0, 240, 63, 154, 32, 0, 160, 68, 0, 0, 0, 0, 0, 0, 224, 63, 160, 32, 0, 32, 3, 32, 1, 32, 2, 16, 8, 32, 3, 16, 0, 11]
);
var mod = new WebAssembly.Module(code);
var instance = new WebAssembly.Instance(mod, { lib: lib });
var slider = document.getElementById('slider');
function main() {
    mem.length = 0;
    instance.exports.main(slider.value / 500);
    ctx.putImageData(imageData, 0, 0);
}
main();
slider.oninput = main;
</script>
</body>
</html>
